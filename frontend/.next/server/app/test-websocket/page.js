(()=>{var e={};e.id=976,e.ids=[976],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6624:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c});var r=s(482),l=s(9108),a=s(2563),n=s.n(a),o=s(8300),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);s.d(t,i);let c=["",{children:["test-websocket",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,2362)),"/Volumes/Extreme SSD/02_GitHub.nosync/30_OmniVibePro/frontend/app/test-websocket/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,2917)),"/Volumes/Extreme SSD/02_GitHub.nosync/30_OmniVibePro/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],d=["/Volumes/Extreme SSD/02_GitHub.nosync/30_OmniVibePro/frontend/app/test-websocket/page.tsx"],u="/test-websocket/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/test-websocket/page",pathname:"/test-websocket",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},1465:()=>{},2582:(e,t,s)=>{Promise.resolve().then(s.bind(s,1637))},9555:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2583,23)),Promise.resolve().then(s.t.bind(s,6840,23)),Promise.resolve().then(s.t.bind(s,8771,23)),Promise.resolve().then(s.t.bind(s,3225,23)),Promise.resolve().then(s.t.bind(s,9295,23)),Promise.resolve().then(s.t.bind(s,3982,23))},1637:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(5344),l=s(3729),a=s(9437);function n(){let[e,t]=(0,l.useState)(""),[s,n]=(0,l.useState)(!1),[o,i]=(0,l.useState)(null),[c,d]=(0,l.useState)(null),u=()=>{if(!e.trim()){alert("Task ID를 입력하세요");return}n(!0),i(null),d(null)};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-12",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[r.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"WebSocket 진행률 테스트"}),r.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"ProgressBar 컴포넌트와 useWebSocket 훅의 실시간 진행률 추적, 자동 재연결, 폴링 Fallback 기능을 테스트합니다."})]}),(0,r.jsxs)("div",{className:"max-w-3xl mx-auto bg-white rounded-xl shadow-2xl overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 p-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"실시간 작업 모니터링"}),r.jsx("p",{className:"text-blue-100",children:"Task ID를 입력하여 백엔드 작업의 진행 상황을 추적하세요"})]}),(0,r.jsxs)("div",{className:"p-8",children:[!s&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"taskId",className:"block text-sm font-medium text-gray-700 mb-2",children:"Task ID"}),r.jsx("input",{id:"taskId",type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"예: audio_generation_12345",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900",onKeyPress:e=>"Enter"===e.key&&u()}),r.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"백엔드에서 생성된 Task ID를 입력하세요"})]}),r.jsx("button",{onClick:u,className:"w-full px-6 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 font-semibold text-lg shadow-lg transition-all",children:"연결 시작"}),(0,r.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"예시 Task ID"}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("button",{onClick:()=>t("test_task_001"),className:"w-full text-left px-3 py-2 bg-white border border-gray-300 rounded hover:bg-gray-50 text-sm text-gray-700",children:"test_task_001"}),r.jsx("button",{onClick:()=>t("audio_generation_12345"),className:"w-full text-left px-3 py-2 bg-white border border-gray-300 rounded hover:bg-gray-50 text-sm text-gray-700",children:"audio_generation_12345"})]})]})]}),s&&(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("p",{className:"text-sm text-blue-800",children:[r.jsx("span",{className:"font-semibold",children:"Task ID:"})," ",e]})}),r.jsx(a.k,{projectId:e,onCompleted:e=>{console.log("[TestPage] Task completed:",e),i(e),n(!1)},onError:e=>{console.error("[TestPage] Task failed:",e),d(e)},showConnectionStatus:!0}),r.jsx("button",{onClick:()=>{t(""),n(!1),i(null),d(null)},className:"w-full px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 font-medium",children:"초기화"})]}),o&&(0,r.jsxs)("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-6",children:[(0,r.jsxs)("h3",{className:"font-semibold text-green-900 mb-3 flex items-center gap-2",children:[r.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"작업 완료 결과"]}),r.jsx("pre",{className:"bg-white border border-green-300 rounded p-4 text-sm text-gray-800 overflow-x-auto",children:JSON.stringify(o,null,2)})]})]})]}),(0,r.jsxs)("div",{className:"max-w-3xl mx-auto mt-12 grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-lg",children:[r.jsx("div",{className:"text-3xl mb-3",children:"\uD83D\uDD04"}),r.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"자동 재연결"}),r.jsx("p",{className:"text-sm text-gray-600",children:"연결이 끊어지면 exponential backoff 알고리즘으로 자동 재연결합니다"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-lg",children:[r.jsx("div",{className:"text-3xl mb-3",children:"\uD83D\uDCCA"}),r.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"폴링 Fallback"}),r.jsx("p",{className:"text-sm text-gray-600",children:"WebSocket 실패 시 자동으로 HTTP 폴링으로 전환하여 안정성을 보장합니다"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-lg",children:[r.jsx("div",{className:"text-3xl mb-3",children:"\uD83D\uDC93"}),r.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Keep-alive"}),r.jsx("p",{className:"text-sm text-gray-600",children:"30초마다 ping을 전송하여 연결 상태를 유지하고 타임아웃을 방지합니다"})]})]}),(0,r.jsxs)("div",{className:"max-w-3xl mx-auto mt-12 bg-gray-800 rounded-lg p-6 text-gray-100",children:[(0,r.jsxs)("h3",{className:"font-semibold text-xl mb-4 flex items-center gap-2",children:[r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"백엔드 설정 방법"]}),(0,r.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,r.jsxs)("p",{children:["1. 백엔드 서버가 ",r.jsx("code",{className:"bg-gray-700 px-2 py-1 rounded",children:"localhost:8000"}),"에서 실행 중이어야 합니다"]}),(0,r.jsxs)("p",{children:["2. WebSocket 엔드포인트: ",(0,r.jsxs)("code",{className:"bg-gray-700 px-2 py-1 rounded",children:["ws://localhost:8000/api/v1/ws/projects/","{task_id}","/stream"]})]}),(0,r.jsxs)("p",{children:["3. 폴링 엔드포인트: ",(0,r.jsxs)("code",{className:"bg-gray-700 px-2 py-1 rounded",children:["GET /api/v1/projects/","{task_id}","/status"]})]}),r.jsx("p",{className:"text-yellow-400",children:"⚠️ 백엔드에서 위 엔드포인트가 구현되어 있어야 정상 작동합니다"})]})]})]})})}},9437:(e,t,s)=>{"use strict";s.d(t,{k:()=>a});var r=s(5344),l=s(3729);function a({projectId:e,onCompleted:t,onError:s,className:a="",backendUrl:n="localhost:8000",showConnectionStatus:o=!0}){let[i,c]=(0,l.useState)(0),[d,u]=(0,l.useState)(""),[m,x]=(0,l.useState)(null),[g,p]=(0,l.useState)("idle"),{isConnected:h,isFallback:b,reconnectAttempts:f}=function({projectId:e,onMessage:t,onProgress:s,onError:r,onCompleted:a,autoReconnect:n=!0,maxReconnectAttempts:o=5,pollingFallback:i=!0,pollingInterval:c=2e3,backendUrl:d="localhost:8000"}){let[u,m]=(0,l.useState)(!1),[x,g]=(0,l.useState)(!1),[p,h]=(0,l.useState)(0),b=(0,l.useRef)(null),f=(0,l.useRef)(null),v=(0,l.useRef)(null),j=(0,l.useRef)(null),y=(0,l.useCallback)(()=>{if(b.current?.readyState===WebSocket.OPEN)return;let l=`ws://${d}/api/v1/ws/projects/${e}/stream`;try{let e=new WebSocket(l);e.onopen=()=>{console.log("[WebSocket] Connected to:",l),m(!0),h(0),g(!1),v.current=setInterval(()=>{e.readyState===WebSocket.OPEN&&(e.send("ping"),console.log("[WebSocket] Ping sent"))},3e4)},e.onmessage=e=>{try{let l=JSON.parse(e.data);console.log("[WebSocket] Message received:",l),t?.(l),"progress"===l.type&&void 0!==l.progress&&s?.(l.progress,l.message||""),"error"===l.type&&r?.(l.error||"Unknown error"),"completed"===l.type&&a?.(l.result)}catch(e){console.error("[WebSocket] Failed to parse message:",e)}},e.onerror=e=>{console.error("[WebSocket] Error:",e)},e.onclose=e=>{if(console.log("[WebSocket] Closed:",e.code,e.reason),m(!1),v.current&&(clearInterval(v.current),v.current=null),n&&p<o){let e=Math.min(1e3*Math.pow(2,p),3e4);console.log(`[WebSocket] Reconnecting in ${e}ms... (attempt ${p+1}/${o})`),f.current=setTimeout(()=>{h(e=>e+1),y()},e)}else i&&p>=o&&(console.log("[WebSocket] Max reconnect attempts reached. Falling back to polling..."),g(!0),N())},b.current=e}catch(e){console.error("[WebSocket] Failed to create WebSocket:",e),i&&(console.log("[WebSocket] Falling back to polling..."),g(!0),N())}},[e,p,t,s,r,a,n,o,i,d]),N=(0,l.useCallback)(()=>{if(j.current)return;let t=async()=>{try{let t=await fetch(`http://${d}/api/v1/projects/${e}/status`);if(!t.ok)throw Error(`HTTP ${t.status}: ${t.statusText}`);let l=await t.json();console.log("[Polling] Status received:",l);let n="number"==typeof l.progress?l.progress:0;s?.(n,l.message||l.status||""),"completed"===l.status&&(a?.(l.result||l),k()),("failed"===l.status||"error"===l.status)&&(r?.(l.error||"Task failed"),k())}catch(e){console.error("[Polling] Error:",e)}};t(),j.current=setInterval(t,c)},[e,s,a,r,c,d]),k=(0,l.useCallback)(()=>{j.current&&(clearInterval(j.current),j.current=null,console.log("[Polling] Stopped"))},[]),w=(0,l.useCallback)(()=>{console.log("[WebSocket] Disconnecting..."),b.current&&(b.current.close(),b.current=null),f.current&&(clearTimeout(f.current),f.current=null),v.current&&(clearInterval(v.current),v.current=null),k()},[k]);return(0,l.useEffect)(()=>(y(),()=>{w()}),[y,w]),{isConnected:u,isFallback:x,reconnectAttempts:p,disconnect:w}}({projectId:e,backendUrl:n,onProgress:(e,t)=>{c(100*e),u(t),p("running"),x(null)},onError:e=>{x(e),p("error"),s?.(e)},onCompleted:e=>{c(100),u("완료!"),p("completed"),t?.(e)},onMessage:e=>{"connected"===e.type&&p("idle")}});return(0,r.jsxs)("div",{className:`w-full ${a}`,children:[o&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${h?"bg-green-500":b?"bg-yellow-500":f>0?"bg-orange-500":"bg-gray-400"} animate-pulse`}),r.jsx("span",{className:"text-sm text-gray-600",children:b?"폴링 모드":h?"실시간 연결":f>0?`재연결 중... (${f})`:"연결 중..."})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-2 overflow-hidden",children:r.jsx("div",{className:`h-4 rounded-full transition-all duration-300 ${"error"===g?"bg-red-600":"completed"===g?"bg-green-600":i<30?"bg-blue-400":i<70?"bg-blue-500":"bg-blue-600"}`,style:{width:`${i}%`},children:"running"===g&&i<100&&r.jsx("div",{className:"h-full w-full bg-gradient-to-r from-transparent via-white to-transparent opacity-20 animate-shimmer"})})}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:`${"error"===g?"text-red-700":"completed"===g?"text-green-700":"text-gray-700"}`,children:d||"대기 중..."}),(0,r.jsxs)("span",{className:"text-gray-500 font-medium",children:[i.toFixed(1),"%"]})]}),m&&r.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 text-red-700 rounded-md text-sm",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[r.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("div",{className:"font-semibold",children:"오류 발생"}),r.jsx("div",{className:"mt-1",children:m})]})]})}),"completed"===g&&r.jsx("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 text-green-700 rounded-md text-sm",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{className:"font-semibold",children:"작업이 성공적으로 완료되었습니다!"})]})})]})}},2917:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a,metadata:()=>l});var r=s(5036);s(7272);let l={title:"OmniVibe Pro - AI Video Automation",description:"AI-powered Omnichannel Video Automation SaaS"};function a({children:e}){return r.jsx("html",{lang:"ko",children:r.jsx("body",{children:e})})}},2362:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>a,__esModule:()=>l,default:()=>n});let r=(0,s(6843).createProxy)(String.raw`/Volumes/Extreme SSD/02_GitHub.nosync/30_OmniVibePro/frontend/app/test-websocket/page.tsx`),{__esModule:l,$$typeof:a}=r,n=r.default},7272:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,356],()=>s(6624));module.exports=r})();