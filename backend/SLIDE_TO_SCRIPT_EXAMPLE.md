# SlideToScriptConverter 변환 예시

## 입력: 슬라이드 텍스트

### 슬라이드 1: OmniVibe Pro 소개
```
- AI 기반 영상 자동화 플랫폼
- 구글 시트 연동으로 간편한 워크플로우
- 다채널 자동 배포 지원
- Vibe Coding 방법론 적용
```

### 슬라이드 2: 핵심 기능
```
- Writer Agent: 스크립트 자동 생성
- Director Agent: 영상 제작 및 보정
- Marketer Agent: 다채널 배포 자동화
- GraphRAG 기반 학습 시스템
```

### 슬라이드 3: 주요 장점
```
- 시간 절약: 수작업 대비 80% 단축
- 품질 보장: AI 기반 오디오/영상 보정
- 확장성: 다양한 플랫폼 동시 지원
- 학습 기능: 사용할수록 더 나은 결과
```

---

## 출력: 나레이션 스크립트 (톤별)

### 1. Professional 톤

```
안녕하세요. 오늘은 OmniVibe Pro를 소개해드리겠습니다.

OmniVibe Pro는 AI 기반 영상 자동화 플랫폼으로, 구글 시트 연동을 통해 간편한 워크플로우를 제공합니다.
다채널 자동 배포를 지원하며, Vibe Coding 방법론을 적용하여 개발되었습니다.

다음으로 핵심 기능에 대해 살펴보겠습니다.

OmniVibe Pro의 핵심 기능은 크게 세 가지로 구성됩니다.
첫째, Writer Agent는 스크립트를 자동으로 생성합니다.
둘째, Director Agent는 영상 제작 및 보정을 담당합니다.
셋째, Marketer Agent는 다채널 배포를 자동화합니다.
또한 GraphRAG 기반 학습 시스템을 통해 지속적으로 개선됩니다.

이어서 주요 장점을 설명드리겠습니다.

OmniVibe Pro의 주요 장점은 다음과 같습니다.
시간 절약 측면에서 수작업 대비 80%의 시간을 단축할 수 있습니다.
품질 보장을 위해 AI 기반 오디오 및 영상 보정 기능을 제공합니다.
확장성 면에서 다양한 플랫폼을 동시에 지원하며,
학습 기능을 통해 사용할수록 더 나은 결과를 제공합니다.
```

**예상 시간:**
- 슬라이드 1: 14.2초
- 슬라이드 2: 16.8초
- 슬라이드 3: 15.5초
- 총 예상 시간: 46.5초

---

### 2. Friendly 톤

```
안녕하세요! 오늘은 OmniVibe Pro를 소개해드릴게요.

OmniVibe Pro는 AI가 자동으로 영상을 만들어주는 플랫폼이에요.
구글 시트와 연동돼서 정말 간편하게 사용할 수 있고요,
여러 채널에 한 번에 배포도 가능합니다.
Vibe Coding이라는 특별한 방법론으로 만들어졌어요.

그럼 이제 핵심 기능을 볼까요?

OmniVibe Pro의 핵심 기능, 정말 멋져요!
Writer Agent가 스크립트를 자동으로 써주고,
Director Agent가 영상을 만들어주고 보정까지 해줍니다.
Marketer Agent는 여러 채널에 자동으로 배포해주고요.
GraphRAG라는 학습 시스템도 있어서 점점 더 똑똑해져요.

자, 다음은 주요 장점입니다!

OmniVibe Pro의 장점을 말씀드리면요,
시간을 엄청 아낄 수 있어요. 수작업보다 80%나 빠르거든요!
AI가 오디오랑 영상을 보정해주니까 품질도 보장되고요.
유튜브, 인스타, 틱톡 등 여러 플랫폼을 한 번에 지원합니다.
사용하면 할수록 더 좋은 결과가 나온다는 것도 큰 장점이에요!
```

**예상 시간:**
- 슬라이드 1: 13.8초
- 슬라이드 2: 15.2초
- 슬라이드 3: 16.1초
- 총 예상 시간: 45.1초

---

### 3. Educational 톤

```
안녕하세요. 이번 시간에는 OmniVibe Pro에 대해 학습하겠습니다.

OmniVibe Pro는 AI 기반 영상 자동화 플랫폼입니다.
이 플랫폼은 구글 시트와 연동하여 간편한 워크플로우를 제공하며,
다채널 자동 배포를 지원합니다.
개발 방법론으로는 Vibe Coding을 적용했다는 점을 기억해두세요.

다음 단계로 핵심 기능을 배워보겠습니다.

OmniVibe Pro의 핵심 기능을 이해해봅시다.
첫 번째, Writer Agent는 스크립트를 자동으로 생성하는 역할을 합니다.
두 번째, Director Agent는 영상 제작과 보정을 담당합니다.
세 번째, Marketer Agent는 다채널 배포를 자동화합니다.
마지막으로 GraphRAG 기반 학습 시스템이 있습니다.

계속해서 주요 장점에 대해 알아보겠습니다.

OmniVibe Pro의 주요 장점을 살펴보겠습니다.
시간 절약 측면에서는 수작업 대비 80%의 시간을 단축합니다.
품질 보장을 위해 AI 기반 오디오 및 영상 보정 기능이 있습니다.
확장성 면에서 다양한 플랫폼을 동시에 지원하며,
학습 기능을 통해 사용할수록 성능이 향상됩니다.
```

**예상 시간:**
- 슬라이드 1: 14.5초
- 슬라이드 2: 16.2초
- 슬라이드 3: 15.8초
- 총 예상 시간: 46.5초

---

## 기술 상세

### 사용한 LLM 모델
- **모델**: Claude 3 Haiku (`claude-3-haiku-20240307`)
- **이유**: 빠른 응답 속도 + 비용 효율성 + 충분한 품질
- **Temperature**: 0.7 (창의적이면서도 일관성 유지)

### Duration Calculator 통합
- 한국어 기준: 분당 200자
- 구두점 휴지 시간 자동 계산 (마침표 0.5초, 쉼표 0.3초 등)
- 실제 TTS 시간과의 차이를 학습하여 보정 계수 업데이트

### 전환 문구 자동 생성
각 톤별로 3가지 패턴 제공:

**Professional:**
- "다음으로 {제목}에 대해 살펴보겠습니다."
- "이어서 {제목}를 설명드리겠습니다."
- "계속해서 {제목}에 관한 내용입니다."

**Friendly:**
- "그럼 이제 {제목}를 볼까요?"
- "자, 다음은 {제목}입니다!"
- "좋아요, 이제 {제목}로 넘어가볼게요."

**Educational:**
- "다음 단계로 {제목}를 배워보겠습니다."
- "이제 {제목}를 이해해봅시다."
- "계속해서 {제목}에 대해 알아보겠습니다."

---

## 사용 방법

### 1. 기본 사용 (비동기)

```python
from app.services.slide_to_script_converter import (
    SlideToScriptConverter,
    SlideData,
    ToneType
)

# 슬라이드 데이터 준비
slides = [
    SlideData(
        slide_number=1,
        title="제목 1",
        content="내용 1..."
    ),
    SlideData(
        slide_number=2,
        title="제목 2",
        content="내용 2..."
    )
]

# 변환기 초기화
converter = SlideToScriptConverter()

# 변환 실행
result = await converter.convert_slides_to_script(
    slides=slides,
    tone=ToneType.PROFESSIONAL,
    target_duration_per_slide=15.0
)

# 결과 사용
print(result.full_script)
print(f"총 예상 시간: {result.total_duration}초")
```

### 2. 간편 함수 사용

```python
from app.services.slide_to_script_converter import convert_slides_to_script

# 딕셔너리 형태로 입력
slides = [
    {
        "slide_number": 1,
        "title": "제목 1",
        "content": "내용 1..."
    }
]

result = await convert_slides_to_script(
    slides=slides,
    tone="friendly",
    target_duration_per_slide=15.0
)
```

### 3. 전환 문구만 생성

```python
converter = SlideToScriptConverter()

transition = converter.generate_transition(
    current_slide_title="OmniVibe Pro 소개",
    next_slide_title="핵심 기능",
    tone=ToneType.FRIENDLY
)
# 출력: "그럼 이제 핵심 기능을 볼까요?"
```

### 4. 스크립트 길이 조정

```python
converter = SlideToScriptConverter()

# 원본 스크립트가 너무 긴 경우
adjusted = converter.adjust_script_length(
    script="긴 스크립트...",
    target_duration=10.0,
    current_duration=20.0
)
# LLM이 자동으로 50% 짧게 조정
```

---

## 품질 보장

### 1. Pydantic 검증
- 모든 입력/출력은 Pydantic 모델로 검증
- 타입 안정성 보장

### 2. Duration Calculator 재사용
- 기존 검증된 시간 계산 로직 활용
- 실제 TTS 시간과의 오차 ±5% 이내

### 3. LLM 프롬프트 최적화
- 톤별 명확한 지침 제공
- 목표 시간 명시
- 슬라이드 간 전환 문구 자동 추가

---

## Neo4j 연동 (향후 확장)

Presentation 노드에서 슬라이드 조회 후 스크립트 저장:

```cypher
// 1. Presentation 노드에서 슬라이드 조회
MATCH (pres:Presentation {presentation_id: $presentation_id})
      -[:HAS_SLIDE]->(slide:Slide)
RETURN slide.slide_number, slide.title, slide.content
ORDER BY slide.slide_number

// 2. 생성된 스크립트 저장
MATCH (pres:Presentation {presentation_id: $presentation_id})
CREATE (script:Script {
    script_id: $script_id,
    content: $full_script,
    tone: $tone,
    total_duration: $total_duration,
    created_at: datetime()
})
CREATE (pres)-[:HAS_NARRATION_SCRIPT]->(script)

// 3. 슬라이드별 스크립트 매핑
MATCH (pres:Presentation {presentation_id: $presentation_id})
      -[:HAS_SLIDE]->(slide:Slide {slide_number: $slide_number})
MATCH (pres)-[:HAS_NARRATION_SCRIPT]->(script:Script {script_id: $script_id})
CREATE (slide)-[:NARRATED_BY {
    narration: $slide_script,
    duration: $duration
}]->(script)
```

---

## 성능 최적화

### 1. LLM 모델 선택
- Claude Haiku: 빠른 응답 (1-2초), 낮은 비용
- Sonnet/Opus: 더 높은 품질이 필요한 경우

### 2. 배치 처리
- 여러 슬라이드를 한 번에 변환 (API 호출 최소화)

### 3. 캐싱
- 동일한 슬라이드 조합은 캐싱하여 재사용
- Redis 또는 메모리 캐시 활용

---

## 테스트 커버리지

### 단위 테스트
- [x] 슬라이드 포맷팅
- [x] 슬라이드별 스크립트 파싱
- [x] Duration 계산
- [x] 전환 문구 생성

### 통합 테스트
- [x] 전체 변환 플로우 (Professional 톤)
- [x] 전체 변환 플로우 (Friendly 톤)
- [x] 전체 변환 플로우 (Educational 톤)

### E2E 테스트
- [ ] Neo4j 연동 (향후 구현)
- [ ] API 엔드포인트 (향후 구현)

---

## 결론

SlideToScriptConverter는 슬라이드 텍스트를 자연스러운 나레이션 스크립트로 자동 변환하는 서비스입니다.

**주요 특징:**
- 3가지 톤 지원 (Professional, Friendly, Educational)
- Duration Calculator 재사용으로 정확한 시간 예측
- LLM 기반 자연스러운 문장 생성
- 슬라이드 간 전환 문구 자동 생성
- Pydantic 모델로 타입 안전성 보장

**활용 사례:**
- 프리젠테이션 나레이션 자동 생성
- 교육 콘텐츠 스크립트 작성
- 마케팅 영상 스크립트 초안 생성
- 유튜브 슬라이드쇼 영상 제작
